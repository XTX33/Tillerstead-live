/**
 * Performance Optimization Helper
 * Creates responsive image markup with WebP support
 * 
 * Usage in templates:
 * {% include responsive-image.html
 *    src="portfolio/bathroom.jpg"
 *    alt="Modern bathroom remodel"
 *    sizes="(max-width: 768px) 100vw, 50vw"
 * %}
 */

<!-- Responsive Picture Element with WebP Support -->
{% assign img_base = include.src | remove: '.jpg' | remove: '.jpeg' | remove: '.png' %}
{% assign img_alt = include.alt | default: "" %}
{% assign img_sizes = include.sizes | default: "100vw" %}
{% assign img_class = include.class | default: "" %}
{% assign img_loading = include.loading | default: "lazy" %}

<picture class="responsive-image {{ img_class }}">
  <!-- WebP sources for modern browsers -->
  <source
    type="image/webp"
    srcset="
      /assets/img/optimized/{{ img_base }}-small.webp 400w,
      /assets/img/optimized/{{ img_base }}-medium.webp 800w,
      /assets/img/optimized/{{ img_base }}-large.webp 1200w,
      /assets/img/optimized/{{ img_base }}-xlarge.webp 1920w
    "
    sizes="{{ img_sizes }}"
  />
  
  <!-- Fallback for browsers without WebP support -->
  <img
    src="/assets/img/{{ include.src }}"
    srcset="
      /assets/img/optimized/{{ img_base }}-small.webp 400w,
      /assets/img/optimized/{{ img_base }}-medium.webp 800w,
      /assets/img/optimized/{{ img_base }}-large.webp 1200w
    "
    sizes="{{ img_sizes }}"
    alt="{{ img_alt }}"
    loading="{{ img_loading }}"
    decoding="async"
    class="responsive-img"
  />
</picture>
